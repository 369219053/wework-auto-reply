# 批量邀请好友进群功能 - 使用指南

## 📖 功能概述

批量邀请功能允许您一次性邀请多个好友进入指定的企业微信群聊，大幅提升群聊管理效率。

### ✨ 核心特性

- ✅ **批量邀请** - 一次性邀请多个好友进群
- ✅ **部门匹配** - 支持指定部门精准匹配同名好友
- ✅ **智能跳过** - 自动跳过已在群内的好友
- ✅ **容错处理** - 自动跳过搜索不到的好友
- ✅ **进度反馈** - 实时显示邀请进度和结果

---

## 🚀 快速开始

### 第一步: 准备好友列表

在主界面的"邀请好友列表"输入框中，按以下格式输入好友名称：

```
天天一泉～小石榴
创视空间
April
群助理|望帅
宝栗@远方好物
```

**格式说明**:
- 每行一个好友名称
- 如需指定部门，使用 `|` 分隔，格式: `好友名称|部门名称`
- 例如: `群助理|望帅` 表示搜索"群助理"且部门为"望帅"的好友

### 第二步: 输入目标群聊名称

在"群聊名称"输入框中输入要邀请好友进入的群聊名称，例如: `智界Aigc客户群`

### 第三步: 启动批量邀请

1. 点击 **"👥 批量邀请好友进群"** 按钮
2. 应用会自动最小化并打开企业微信
3. 自动执行以下流程:
   - 搜索目标群聊
   - 进入群聊详情页
   - 点击+号添加成员
   - 依次搜索并邀请每个好友

### 第四步: 查看结果

在主界面的日志区域可以看到:
- ✅ 成功邀请的好友
- ⏭️ 跳过的好友(已在群内/搜索不到/部门不匹配)
- 📊 总体进度

---

## 📋 使用场景

### 场景1: 邀请新客户进群

```
张三
李四
王五
```

### 场景2: 邀请特定部门的同事

```
张三|销售部
李四|技术部
王五|市场部
```

### 场景3: 混合邀请

```
张三
李四|销售部
王五
赵六|技术部
```

---

## ⚙️ 工作原理

### 完整流程

1. **搜索群聊** - 在企业微信消息页面搜索目标群聊
2. **进入群详情** - 点击群聊进入群详情页面
3. **点击+号** - 点击群详情页面的+号按钮
4. **点击我的客户** - 选择"我的客户"选项
5. **点击搜索** - 点击放大镜图标进入搜索页面
6. **搜索好友** - 输入好友名称并搜索
7. **选择好友** - 从搜索结果中选择匹配的好友
8. **确认邀请** - 点击确定按钮完成邀请
9. **继续下一个** - 重复步骤5-8直到所有好友邀请完成

### 智能匹配逻辑

#### 部门匹配
- 如果指定了部门(使用 `|` 分隔)，必须严格匹配部门
- 如果未指定部门，选择第一个搜索结果
- 部门不匹配时自动跳过该好友

#### 状态检测
- 检测好友是否已在群内(enabled=false)
- 已在群内的好友自动跳过
- 搜索不到的好友自动跳过

#### 容错机制
- 搜索失败自动跳过
- 点击失败自动重试
- 页面异常自动返回

---

## 🔧 高级配置

### 自定义等待时间

如果您的网络较慢或手机性能较低，可能需要调整代码中的等待时间：

<augment_code_snippet path="wework-auto-reply/app/src/main/java/com/wework/autoreply/WeworkAutoService.kt" mode="EXCERPT">
````kotlin
// 搜索后等待结果加载
Thread.sleep(1500)  // 可以调整为2000或更长
````
</augment_code_snippet>

### 修改搜索策略

默认情况下，系统会在RecyclerView和ListView中搜索好友。如果需要修改搜索范围，可以调整相关代码。

---

## ❓ 常见问题

详见: [批量邀请功能-常见问题](./批量邀请功能-常见问题.md)

---

## 📅 版本历史

### V3.4 (2025-12-25)
- ✅ 修复两个页面层级导致的重复点击问题
- ✅ 支持ListView和RecyclerView双重容器
- ✅ 修复部门不匹配时的返回问题
- ✅ 修复好友已在群里时的跳过逻辑
- ✅ 整合测试功能到主界面

### V3.3 (2025-12-24)
- ✅ 实现放大镜按钮点击功能
- ✅ 使用节点遍历+坐标匹配方案

### V3.2 (2025-12-23)
- ✅ 实现批量邀请核心功能
- ✅ 支持部门精准匹配

### V3.1 (2025-12-22)
- ✅ 实现搜索和选择好友功能

### V3.0 (2025-12-21)
- ✅ 项目初始化
- ✅ 实现基础UI和数据结构

