# 📱 MacroDroid详细配置教程

## 📖 目录

1. [MacroDroid介绍](#macrodroid介绍)
2. [安装和设置](#安装和设置)
3. [核心概念](#核心概念)
4. [企微自动回复配置](#企微自动回复配置)
5. [高级功能](#高级功能)
6. [故障排查](#故障排查)

---

## 📱 MacroDroid介绍

### 什么是MacroDroid?

MacroDroid是一款Android自动化应用,可以通过简单的配置实现复杂的自动化任务。

### 核心优势

- ✅ **无需编程** - 可视化配置,拖拽即可
- ✅ **功能强大** - 支持数百种触发器和动作
- ✅ **稳定可靠** - 后台运行,自动执行
- ✅ **免费使用** - 基础功能完全免费

### 版本选择

| 版本 | 价格 | 功能限制 |
|------|------|---------|
| 免费版 | ¥0 | 最多5个宏 |
| 专业版 | ¥30 | 无限制 |

**建议:** 企微自动回复只需要1个宏,免费版完全够用!

---

## 🔧 安装和设置

### 第一步: 下载安装

#### 方法1: Google Play(推荐)
```
1. 打开Google Play
2. 搜索"MacroDroid"
3. 点击"安装"
4. 等待安装完成
```

#### 方法2: APK直接安装
```
1. 访问: https://www.macrodroid.com/
2. 下载最新版APK
3. 允许安装未知来源
4. 点击APK安装
```

### 第二步: 首次启动配置

```
1. 打开MacroDroid
2. 选择语言(中文)
3. 点击"开始使用"
4. 跳过教程(或快速浏览)
```

### 第三步: 授予权限

#### 1. 无障碍权限(必须)

**为什么需要:**
- 自动点击界面元素
- 自动输入文本
- 自动执行操作

**如何授予:**
```
MacroDroid → 设置 → 配置无障碍服务
→ 找到MacroDroid → 开启
→ 点击"允许"
```

**注意事项:**
- 部分手机厂商(小米、华为等)可能会自动关闭无障碍服务
- 需要在手机设置中将MacroDroid加入"自启动白名单"
- 需要关闭"电池优化"

#### 2. 通知访问权限(必须)

**为什么需要:**
- 监听应用通知
- 读取通知内容
- 触发自动化规则

**如何授予:**
```
MacroDroid → 设置 → 通知访问权限
→ 找到MacroDroid → 开启
```

#### 3. 其他权限(建议)

- **悬浮窗权限** - 显示执行状态
- **存储权限** - 保存日志和配置
- **网络权限** - 同步云端配置(可选)

---

## 🧠 核心概念

### MacroDroid的三要素

```
┌─────────────────────────────────┐
│         Macro (宏)              │
├─────────────────────────────────┤
│  Triggers (触发器)              │
│  ↓ 什么时候执行?                │
│                                 │
│  Actions (动作)                 │
│  ↓ 执行什么操作?                │
│                                 │
│  Constraints (约束)             │
│  ↓ 在什么条件下执行?            │
└─────────────────────────────────┘
```

### 1. Triggers (触发器)

**定义:** 触发自动化的条件

**常用触发器:**
- **Notification** - 收到通知时
- **Time** - 特定时间
- **Location** - 到达特定位置
- **Battery** - 电量变化时
- **Screen On/Off** - 屏幕开关时

**企微自动回复使用:** Notification触发器

### 2. Actions (动作)

**定义:** 触发后执行的操作

**常用动作:**
- **Click Notification** - 点击通知
- **Type Text** - 输入文本
- **Press Key** - 按键
- **Wait** - 等待
- **Launch App** - 启动应用

**企微自动回复使用:** 点击通知 → 输入文本 → 发送

### 3. Constraints (约束)

**定义:** 限制执行的条件

**常用约束:**
- **Time** - 时间段限制
- **Day of Week** - 星期限制
- **Battery** - 电量限制
- **WiFi** - WiFi连接状态

**企微自动回复使用:** 可选,如只在工作时间执行

---

## 🎯 企微自动回复配置

### 完整配置流程

#### 第一步: 创建新宏

```
1. 打开MacroDroid
2. 点击右下角"+"按钮
3. 输入名称: "企微自动回复"
4. 选择分类: "工作"(可选)
5. 点击"确定"
```

#### 第二步: 配置触发器

```
1. 点击"Triggers"区域的"+"
2. 选择"Notification"
3. 配置通知触发器:
   - Application: 企业微信
   - Title Filter: "新的朋友"
   - Text Filter: (留空)
   - Get Notification Text: 开启(可选)
4. 点击"确定"
```

**高级配置:**
```
- Notification Action: Click Notification
- Notification Removed: 不勾选
- Persistent Notification: 不勾选
```

#### 第三步: 配置动作序列

**动作序列设计:**
```
等待2秒 → 点击通知 → 等待1秒 → 输入文本 → 发送 → 返回主屏幕
```

**详细配置:**

##### 动作1: Wait (等待2秒)
```
Actions → + → Wait
- Duration: 2秒
- 说明: 等待通知完全显示
```

##### 动作2: Click Notification (点击通知)
```
Actions → + → Click Notification
- Application: 企业微信
- 说明: 自动点击通知打开聊天窗口
```

##### 动作3: Wait (等待1秒)
```
Actions → + → Wait
- Duration: 1秒
- 说明: 等待聊天窗口打开
```

##### 动作4: Type Text (输入文本)
```
Actions → + → Type Text
- Text: "您好!欢迎添加,请点击链接加入我们的群聊: [群聊链接]"
- 说明: 自动输入欢迎语
```

**重要:** 将`[群聊链接]`替换为实际的群聊邀请链接!

##### 动作5: Press Key (发送)
```
Actions → + → Press Key
- Key: Enter
- 说明: 发送消息
```

##### 动作6: Go Home (返回主屏幕)
```
Actions → + → Go Home
- 说明: 返回主屏幕,避免停留在聊天界面
```

#### 第四步: 配置约束(可选)

**示例: 只在工作时间执行**
```
Constraints → + → Time
- Start Time: 09:00
- End Time: 18:00
```

**示例: 只在工作日执行**
```
Constraints → + → Day of Week
- 选择: 周一到周五
```

#### 第五步: 保存和启用

```
1. 点击右上角"✓"保存
2. 确认宏已启用(绿色开关)
3. 测试运行
```

---

## 🚀 高级功能

### 1. 变量使用

**场景:** 根据不同时间发送不同的欢迎语

**配置:**
```
Actions → + → If/Then/Else
- Condition: Time
  - 09:00-12:00: "早上好!欢迎添加..."
  - 12:00-18:00: "下午好!欢迎添加..."
  - 18:00-21:00: "晚上好!欢迎添加..."
```

### 2. 多条件触发

**场景:** 监听多个关键词

**配置:**
```
Triggers → + → Notification
- Title Filter: "新的朋友" OR "添加了你" OR "通过了你的好友申请"
```

### 3. 日志记录

**场景:** 记录每次自动回复

**配置:**
```
Actions → + → Write to Log
- Text: "已自动回复: {notification_title}"
- Log File: /sdcard/企微自动回复日志.txt
```

### 4. 通知提醒

**场景:** 执行后发送通知提醒

**配置:**
```
Actions → + → Notification
- Title: "企微自动回复"
- Text: "已自动发送欢迎消息"
```

---

## 🔧 故障排查

### 问题1: 没有自动执行

**可能原因:**
1. 无障碍权限被关闭
2. MacroDroid被系统清理
3. 通知过滤条件不匹配

**解决方法:**
```
1. 检查无障碍权限是否开启
2. 将MacroDroid加入自启动白名单
3. 关闭电池优化
4. 检查触发器的过滤条件
```

### 问题2: 执行了但没有发送消息

**可能原因:**
1. 等待时间太短
2. 输入框未找到
3. 发送按钮未点击

**解决方法:**
```
1. 增加Wait动作的等待时间
2. 检查Type Text动作是否正确
3. 确认Press Key选择的是Enter键
```

### 问题3: 发送的消息不完整

**可能原因:**
1. 文本太长
2. 输入速度太快

**解决方法:**
```
1. 缩短欢迎语内容
2. 在Type Text后增加Wait动作
```

---

## 📚 更多资源

- [MacroDroid官方文档](https://www.macrodroid.com/documentation)
- [MacroDroid社区论坛](https://www.macrodroid.com/forums)
- [常见问题解答](./常见问题解答.md)

---

[返回README](../README.md)

